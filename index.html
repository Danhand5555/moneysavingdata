<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Savings Pitch Deck</title>
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f6f8;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
        }

        h1 {
            text-align: center;
            font-weight: 800;
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #00CC96 0%, #1F2E2E 100%);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
        }

        p.subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        #chart {
            width: 100%;
            height: 700px;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            flex-wrap: wrap;
            /* Allow wrapping on mobile */
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        /* Mobile Optimization */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
                width: 95%;
                /* Use more screen width */
            }

            h1 {
                font-size: 1.5rem;
            }

            p.subtitle {
                font-size: 0.9rem;
            }

            #chart {
                height: 500px;
                /* Smaller chart for mobile */
            }
        }
    </style>
</head>

<body>

    <div class="container">
        <h1>Savings Strategy Pitch Deck</h1>
        <p class="subtitle">Comparing the most effective saving models for a couple.</p>

        <div class="legend">
            <div class="legend-item">
                <div class="dot" style="background: #28a745;"></div>Easy (< 100‡∏ø)</div>
                    <div class="legend-item">
                        <div class="dot" style="background: #ffc107;"></div>Moderate (~ 300‡∏ø)
                    </div>
                    <div class="legend-item">
                        <div class="dot" style="background: #dc3545;"></div>Hard (> 1000‡∏ø)
                    </div>
            </div>

            <div id="chart"></div>
        </div>

        <script>
            // --- LOGIC PORTED FROM PYTHON ---

            const YEAR_DAYS = 365;

            // 1. Calculate savings for N cycles/year
            function calculateYearlySavings(numCycles) {
                const baseLength = Math.floor(YEAR_DAYS / numCycles);
                const remainder = YEAR_DAYS % numCycles;

                let lengths = [];
                for (let i = 0; i < numCycles; i++) {
                    if (i < remainder) lengths.push(baseLength + 1);
                    else lengths.push(baseLength);
                }

                let total = 0;
                let maxDaily = 0;

                lengths.forEach(len => {
                    total += (len * (len + 1)) / 2;
                    if (len > maxDaily) maxDaily = len;
                });

                // Generate description
                let lenSet = new Set(lengths);
                let desc = `${lengths[0]} days`;
                if (lenSet.size > 1) {
                    const avg = Math.round(lengths.reduce((a, b) => a + b, 0) / lengths.length);
                    desc = `~${avg} days`;
                }

                return { total, maxDaily, desc };
            }

            // 2. Generate Data
            let data = [];

            const cycleLabels = {
                1: "Yearly (1)",
                2: "Semi-Annual (2)",
                4: "Quarterly (4)",
                6: "Bi-Monthly (6)",
                12: "Monthly (12)",
                24: "Semi-Monthly (24)",
                26: "Bi-Weekly (26)",
                52: "Weekly (52)",
                365: "Daily (365)"
            };

            const targetCycles = [1, 2, 4, 6, 12, 24, 26, 52, 365];

            targetCycles.forEach(c => {
                const res = calculateYearlySavings(c);
                data.push({
                    label: cycleLabels[c] || c.toString(),
                    total: res.total,
                    totalCouple: res.total * 2,
                    maxDaily: res.maxDaily,
                    desc: res.desc,
                    type: 'Cycle'
                });
            });

            // --- Alternative Strategies ---

            // Fixed Daily
            const fixed = 183;
            data.push({
                label: "Fixed Daily (183‡∏ø)",
                total: fixed * 365,
                totalCouple: (fixed * 365) * 2,
                maxDaily: fixed,
                desc: "Pay same amount every day",
                type: 'Model'
            });

            // 52-Week 
            const wTotal = 68900;
            data.push({
                label: "52-Week Challenge (x50)",
                total: wTotal,
                totalCouple: wTotal * 2,
                maxDaily: 2600,
                desc: "Wk1=50, Wk52=2600",
                type: 'Model'
            });

            // Reverse 52-Week
            data.push({
                label: "Reverse 52-Week",
                total: wTotal,
                totalCouple: wTotal * 2,
                maxDaily: 2600,
                desc: "Start High, End Low",
                type: 'Model'
            });

            // Weekday Ladder
            const ladderTotal = 72800;
            data.push({
                label: "Weekday Ladder",
                total: ladderTotal,
                totalCouple: ladderTotal * 2,
                maxDaily: 350,
                desc: "Mon=50...Sun=350",
                type: 'Model'
            });

            // Payday Sync
            const paydayTotal = 72000;
            data.push({
                label: "Payday Sync (1st&16th)",
                total: paydayTotal,
                totalCouple: paydayTotal * 2,
                maxDaily: 3000,
                desc: "3000‡∏ø on Paydays Only",
                type: 'Model'
            });

            // No-Spend Weekends
            const noSpendTotal = 78000;
            data.push({
                label: "No-Spend Weekends",
                total: noSpendTotal,
                totalCouple: noSpendTotal * 2,
                maxDaily: 300,
                desc: "M-F 300‡∏ø, Sat-Sun 0‡∏ø",
                type: 'Model'
            });

            // Aggressive Ladder
            const aggTotal = 145600;
            data.push({
                label: "Aggressive Ladder",
                total: aggTotal,
                totalCouple: aggTotal * 2,
                maxDaily: 700,
                desc: "Mon=100...Sun=700",
                type: 'Model'
            });

            // Weekend Binge
            const bingeTotal = 104000;
            data.push({
                label: "Weekend Binge",
                total: bingeTotal,
                totalCouple: bingeTotal * 2,
                maxDaily: 1000,
                desc: "M-F 0‡∏ø, Sat/Sun 1k",
                type: 'Model'
            });

            // Odd/Even
            const oddEvenTotal = 100150;
            data.push({
                label: "Odd/Even Smasher",
                total: oddEvenTotal,
                totalCouple: oddEvenTotal * 2,
                maxDaily: 500,
                desc: "Odd=50‡∏ø, Even=500‡∏ø",
                type: 'Model'
            });

            // Date Match
            const dateMatchTotal = 57380;
            data.push({
                label: "Date Match (x10)",
                total: dateMatchTotal,
                totalCouple: dateMatchTotal * 2,
                maxDaily: 310,
                desc: "Day 1=10‡∏ø ... Day 31=310‡∏ø",
                type: 'Model'
            });

            // Workday Escalator
            const escalatorTotal = 39000;
            data.push({
                label: "Workday Escalator",
                total: escalatorTotal,
                totalCouple: escalatorTotal * 2,
                maxDaily: 250,
                desc: "M->F 50,100..250. Wknd 0",
                type: 'Model'
            });

            // Coffee Skip
            const coffeeTotal = 21900;
            data.push({
                label: "Coffee Skip (60‡∏ø)",
                total: coffeeTotal,
                totalCouple: coffeeTotal * 2,
                maxDaily: 60,
                desc: "Skip 1 coffee/day",
                type: 'Model'
            });

            // --- SORTING ---
            data.sort((a, b) => b.total - a.total);

            // --- VISUALIZATION ---

            // Extract arrays for Plotly
            const x = data.map(d => d.label);
            const y = data.map(d => d.total);
            const colorMetric = data.map(d => d.maxDaily);
            const tooltips = data.map(d =>
                `<b>${d.label}</b><br>` +
                `Logic: ${d.desc}<br>` +
                `<b>Max Daily Pay: ‡∏ø${d.maxDaily.toLocaleString()}</b><br><br>` +
                `1 Person: ‡∏ø${d.total.toLocaleString()}<br>` +
                `2 People: ‡∏ø${d.totalCouple.toLocaleString()}`
            );

            // Define Color Scale (Green -> Yellow -> Red)
            // We use Plotly's colorscale 'RdYlGn' reversed.

            const trace = {
                x: x,
                y: y,
                type: 'bar',
                marker: {
                    color: colorMetric,
                    // Custom Traffic Light Scale: Green (Low) -> Yellow (Mid) -> Red (High)
                    colorscale: [
                        [0.0, '#00CC96'],  // Green (Easy)
                        [0.2, '#ADCC00'],  // Lime
                        [0.5, '#FFD700'],  // Yellow (Moderate)
                        [0.8, '#FF8C00'],  // Orange
                        [1.0, '#EF553B']   // Red (Hard)
                    ],
                    cmin: 0,
                    cmax: 1000, // Clamp at 1000 for max 'pain' color
                    showscale: true,
                    colorbar: { title: 'Max Daily Pay (‡∏ø)' }
                },
                // Show full numbers on top
                text: y.map(v => '‡∏ø' + v.toLocaleString()),
                textposition: 'outside',
                textfont: { size: 12, weight: 'bold' },
                hovertemplate: '%{customdata}<extra></extra>',
                customdata: tooltips
            };

            const isMobile = window.innerWidth < 768;

            const layout = {
                title: {
                    text: '<b>Ranked Savings Strategies (Pitch Deck)</b><br><sup><span style="color:#00CC96"><b>Green = Easy</b></span> ‚Üí <span style="color:#FFD700"><b>Yellow</b></span> ‚Üí <span style="color:#EF553B"><b>Red = Hard</b></span></sup>',
                    font: { size: isMobile ? 14 : 24 }
                },
                margin: { t: isMobile ? 80 : 120, b: 150, l: isMobile ? 40 : 80, r: isMobile ? 20 : 80 }, // Extra space for labels and rotation
                xaxis: {
                    title: 'Strategy',
                    tickangle: -45
                },
                yaxis: {
                    title: 'Total Savings (‡∏ø)',
                    gridcolor: '#eee'
                },
                template: 'plotly_white',
                shapes: [
                    {
                        type: 'line',
                        y0: 66795,
                        y1: 66795,
                        x0: -0.5,
                        x1: data.length - 0.5,
                        line: {
                            color: 'black',
                            width: 2,
                            dash: 'dashdot'
                        }
                    }
                ],
                annotations: [
                    {
                        x: data.length - 1,
                        y: 66795,
                        xref: 'x',
                        yref: 'y',
                        text: isMobile ? '<b>ORIGINAL</b>' : '<b>ORIGINAL PLAN</b>',
                        showarrow: false,
                        yshift: 10,
                        xshift: -50,
                        font: { color: 'black', size: isMobile ? 10 : 12 }
                    }
                ]
            };

            // Add "Winner" Annotation
            const winnerIdx = data.findIndex(d => d.label === "No-Spend Weekends");
            if (winnerIdx !== -1) {
                layout.annotations.push({
                    x: data[winnerIdx].label,
                    y: data[winnerIdx].total,
                    xref: 'x',
                    yref: 'y',
                    text: 'üèÜ Best Balance',
                    showarrow: true,
                    arrowhead: 2,
                    arrowsize: 1,
                    arrowwidth: 2,
                    arrowcolor: '#00CC96',
                    ax: 0,
                    ay: -40,
                    font: { color: '#00CC96', size: 14, weight: 'bold' }
                });
            }

            Plotly.newPlot('chart', [trace], layout, { responsive: true });

        </script>
</body>

</html>